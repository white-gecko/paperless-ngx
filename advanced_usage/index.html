
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../administration/">
      
      
        <link rel="next" href="../api/">
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.6">
    
    
      
        <title>Advanced Topics - Paperless-ngx</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#advanced-topics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Paperless-ngx" class="md-header__button md-logo" aria-label="Paperless-ngx" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Paperless-ngx
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Advanced Topics
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/paperless-ngx/paperless-ngx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../setup/" class="md-tabs__link">
      Setup
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../usage/" class="md-tabs__link">
      Basic Usage
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../configuration/" class="md-tabs__link">
      Configuration
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../administration/" class="md-tabs__link">
      Administration
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      Advanced Topics
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../api/" class="md-tabs__link">
      REST API
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../development/" class="md-tabs__link">
      Development
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../faq/" class="md-tabs__link">
      FAQs
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../troubleshooting/" class="md-tabs__link">
      Troubleshooting
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../changelog/" class="md-tabs__link">
      Changelog
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Paperless-ngx" class="md-nav__button md-logo" aria-label="Paperless-ngx" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    Paperless-ngx
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/paperless-ngx/paperless-ngx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        Setup
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        Basic Usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../administration/" class="md-nav__link">
        Administration
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Advanced Topics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Advanced Topics
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#matching" class="md-nav__link">
    Matching tags, correspondents, document types, and storage paths
  </a>
  
    <nav class="md-nav" aria-label="Matching tags, correspondents, document types, and storage paths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-matching" class="md-nav__link">
    Automatic matching
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consume-hooks" class="md-nav__link">
    Hooking into the consumption process
  </a>
  
    <nav class="md-nav" aria-label="Hooking into the consumption process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pre-consume-script" class="md-nav__link">
    Pre-consumption script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-consume-script" class="md-nav__link">
    Post-consumption script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-consume-hooks" class="md-nav__link">
    Docker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-name-handling" class="md-nav__link">
    File name handling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-paths" class="md-nav__link">
    Storage paths
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#celery-monitoring" class="md-nav__link">
    Celery Monitoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-container-initialization" class="md-nav__link">
    Custom Container Initialization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mysql-caveats" class="md-nav__link">
    MySQL Caveats
  </a>
  
    <nav class="md-nav" aria-label="MySQL Caveats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-sensitivity" class="md-nav__link">
    Case Sensitivity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        REST API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        Development
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



<h1 id="advanced-topics">Advanced Topics</h1>
<p>Paperless offers a couple features that automate certain tasks and make
your life easier.</p>
<h2 id="matching">Matching tags, correspondents, document types, and storage paths</h2>
<p>Paperless will compare the matching algorithms defined by every tag,
correspondent, document type, and storage path in your database to see
if they apply to the text in a document. In other words, if you define a
tag called <code>Home Utility</code> that had a <code>match</code> property of <code>bc hydro</code> and
a <code>matching_algorithm</code> of <code>literal</code>, Paperless will automatically tag
your newly-consumed document with your <code>Home Utility</code> tag so long as the
text <code>bc hydro</code> appears in the body of the document somewhere.</p>
<p>The matching logic is quite powerful. It supports searching the text of
your document with different algorithms, and as such, some
experimentation may be necessary to get things right.</p>
<p>In order to have a tag, correspondent, document type, or storage path
assigned automatically to newly consumed documents, assign a match and
matching algorithm using the web interface. These settings define when
to assign tags, correspondents, document types, and storage paths to
documents.</p>
<p>The following algorithms are available:</p>
<ul>
<li><strong>Any:</strong> Looks for any occurrence of any word provided in match in
  the PDF. If you define the match as <code>Bank1 Bank2</code>, it will match
  documents containing either of these terms.</li>
<li><strong>All:</strong> Requires that every word provided appears in the PDF,
  albeit not in the order provided.</li>
<li><strong>Literal:</strong> Matches only if the match appears exactly as provided
  (i.e. preserve ordering) in the PDF.</li>
<li><strong>Regular expression:</strong> Parses the match as a regular expression and
  tries to find a match within the document.</li>
<li><strong>Fuzzy match:</strong> I don't know. Look at the source.</li>
<li><strong>Auto:</strong> Tries to automatically match new documents. This does not
  require you to set a match. See the notes below.</li>
</ul>
<p>When using the <em>any</em> or <em>all</em> matching algorithms, you can search for
terms that consist of multiple words by enclosing them in double quotes.
For example, defining a match text of <code>"Bank of America" BofA</code> using the
<em>any</em> algorithm, will match documents that contain either "Bank of
America" or "BofA", but will not match documents containing "Bank of
South America".</p>
<p>Then just save your tag, correspondent, document type, or storage path
and run another document through the consumer. Once complete, you should
see the newly-created document, automatically tagged with the
appropriate data.</p>
<h3 id="automatic-matching">Automatic matching</h3>
<p>Paperless-ngx comes with a new matching algorithm called <em>Auto</em>. This
matching algorithm tries to assign tags, correspondents, document types,
and storage paths to your documents based on how you have already
assigned these on existing documents. It uses a neural network under the
hood.</p>
<p>If, for example, all your bank statements of your account 123 at the
Bank of America are tagged with the tag "bofa123" and the matching
algorithm of this tag is set to <em>Auto</em>, this neural network will examine
your documents and automatically learn when to assign this tag.</p>
<p>Paperless tries to hide much of the involved complexity with this
approach. However, there are a couple caveats you need to keep in mind
when using this feature:</p>
<ul>
<li>Changes to your documents are not immediately reflected by the
  matching algorithm. The neural network needs to be <em>trained</em> on your
  documents after changes. Paperless periodically (default: once each
  hour) checks for changes and does this automatically for you.</li>
<li>The Auto matching algorithm only takes documents into account which
  are NOT placed in your inbox (i.e. have any inbox tags assigned to
  them). This ensures that the neural network only learns from
  documents which you have correctly tagged before.</li>
<li>The matching algorithm can only work if there is a correlation
  between the tag, correspondent, document type, or storage path and
  the document itself. Your bank statements usually contain your bank
  account number and the name of the bank, so this works reasonably
  well, However, tags such as "TODO" cannot be automatically
  assigned.</li>
<li>The matching algorithm needs a reasonable number of documents to
  identify when to assign tags, correspondents, storage paths, and
  types. If one out of a thousand documents has the correspondent
  "Very obscure web shop I bought something five years ago", it will
  probably not assign this correspondent automatically if you buy
  something from them again. The more documents, the better.</li>
<li>Paperless also needs a reasonable amount of negative examples to
  decide when not to assign a certain tag, correspondent, document
  type, or storage path. This will usually be the case as you start
  filling up paperless with documents. Example: If all your documents
  are either from "Webshop" and "Bank", paperless will assign one
  of these correspondents to ANY new document, if both are set to
  automatic matching.</li>
</ul>
<h2 id="consume-hooks">Hooking into the consumption process</h2>
<p>Sometimes you may want to do something arbitrary whenever a document is
consumed. Rather than try to predict what you may want to do, Paperless
lets you execute scripts of your own choosing just before or after a
document is consumed using a couple simple hooks.</p>
<p>Just write a script, put it somewhere that Paperless can read &amp; execute,
and then put the path to that script in <code>paperless.conf</code> or
<code>docker-compose.env</code> with the variable name of either
<code>PAPERLESS_PRE_CONSUME_SCRIPT</code> or <code>PAPERLESS_POST_CONSUME_SCRIPT</code>.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>These scripts are executed in a <strong>blocking</strong> process, which means that
if a script takes a long time to run, it can significantly slow down
your document consumption flow. If you want things to run
asynchronously, you'll have to fork the process in your script and
exit.</p>
</div>
<h3 id="pre-consume-script">Pre-consumption script</h3>
<p>Executed after the consumer sees a new document in the consumption
folder, but before any processing of the document is performed. This
script can access the following relevant environment variables set:</p>
<table>
<thead>
<tr>
<th>Environment Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DOCUMENT_SOURCE_PATH</code></td>
<td>Original path of the consumed document</td>
</tr>
<tr>
<td><code>DOCUMENT_WORKING_PATH</code></td>
<td>Path to a copy of the original that consumption will work on</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pre-consume scripts which modify the document should only change
the <code>DOCUMENT_WORKING_PATH</code> file or a second consume task may
be triggered, leading to failures as two tasks work on the
same document path</p>
</div>
<p>A simple but common example for this would be creating a simple script
like this:</p>
<p><code>/usr/local/bin/ocr-pdf</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>pdf2pdfocr.py<span class="w"> </span>-i<span class="w"> </span><span class="si">${</span><span class="nv">DOCUMENT_WORKING_PATH</span><span class="si">}</span>
</code></pre></div>
<p><code>/etc/paperless.conf</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>...
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nv">PAPERLESS_PRE_CONSUME_SCRIPT</span><span class="o">=</span><span class="s2">&quot;/usr/local/bin/ocr-pdf&quot;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>...
</code></pre></div>
<p>This will pass the path to the document about to be consumed to
<code>/usr/local/bin/ocr-pdf</code>, which will in turn call
<a href="https://github.com/LeoFCardoso/pdf2pdfocr">pdf2pdfocr.py</a> on your
document, which will then overwrite the file with an OCR'd version of
the file and exit. At which point, the consumption process will begin
with the newly modified file.</p>
<p>The script's stdout and stderr will be logged line by line to the
webserver log, along with the exit code of the script.</p>
<h3 id="post-consume-script">Post-consumption script</h3>
<p>Executed after the consumer has successfully processed a document and
has moved it into paperless. It receives the following environment
variables:</p>
<table>
<thead>
<tr>
<th>Environment Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DOCUMENT_ID</code></td>
<td>Database primary key of the document</td>
</tr>
<tr>
<td><code>DOCUMENT_FILE_NAME</code></td>
<td>Formatted filename, not including paths</td>
</tr>
<tr>
<td><code>DOCUMENT_CREATED</code></td>
<td>Date &amp; time when document created</td>
</tr>
<tr>
<td><code>DOCUMENT_MODIFIED</code></td>
<td>Date &amp; time when document was last modified</td>
</tr>
<tr>
<td><code>DOCUMENT_ADDED</code></td>
<td>Date &amp; time when document was added</td>
</tr>
<tr>
<td><code>DOCUMENT_SOURCE_PATH</code></td>
<td>Path to the original document file</td>
</tr>
<tr>
<td><code>DOCUMENT_ARCHIVE_PATH</code></td>
<td>Path to the generate archive file (if any)</td>
</tr>
<tr>
<td><code>DOCUMENT_THUMBNAIL_PATH</code></td>
<td>Path to the generated thumbnail</td>
</tr>
<tr>
<td><code>DOCUMENT_DOWNLOAD_URL</code></td>
<td>URL for document download</td>
</tr>
<tr>
<td><code>DOCUMENT_THUMBNAIL_URL</code></td>
<td>URL for the document thumbnail</td>
</tr>
<tr>
<td><code>DOCUMENT_CORRESPONDENT</code></td>
<td>Assigned correspondent (if any)</td>
</tr>
<tr>
<td><code>DOCUMENT_TAGS</code></td>
<td>Comma separated list of tags applied (if any)</td>
</tr>
<tr>
<td><code>DOCUMENT_ORIGINAL_FILENAME</code></td>
<td>Filename of original document</td>
</tr>
</tbody>
</table>
<p>The script can be in any language, A simple shell script example:</p>
<div class="highlight"><span class="filename">post-consumption-example</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="s2">A document with an id of </span><span class="si">${</span><span class="nv">DOCUMENT_ID</span><span class="si">}</span><span class="s2"> was just consumed.  I know the</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="s2">following additional information about it:</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="s2">* Generated File Name: </span><span class="si">${</span><span class="nv">DOCUMENT_FILE_NAME</span><span class="si">}</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="s2">* Archive Path: </span><span class="si">${</span><span class="nv">DOCUMENT_ARCHIVE_PATH</span><span class="si">}</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="s2">* Source Path: </span><span class="si">${</span><span class="nv">DOCUMENT_SOURCE_PATH</span><span class="si">}</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="s2">* Created: </span><span class="si">${</span><span class="nv">DOCUMENT_CREATED</span><span class="si">}</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="s2">* Added: </span><span class="si">${</span><span class="nv">DOCUMENT_ADDED</span><span class="si">}</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="s2">* Modified: </span><span class="si">${</span><span class="nv">DOCUMENT_MODIFIED</span><span class="si">}</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="s2">* Thumbnail Path: </span><span class="si">${</span><span class="nv">DOCUMENT_THUMBNAIL_PATH</span><span class="si">}</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="s2">* Download URL: </span><span class="si">${</span><span class="nv">DOCUMENT_DOWNLOAD_URL</span><span class="si">}</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="s2">* Thumbnail URL: </span><span class="si">${</span><span class="nv">DOCUMENT_THUMBNAIL_URL</span><span class="si">}</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="s2">* Correspondent: </span><span class="si">${</span><span class="nv">DOCUMENT_CORRESPONDENT</span><span class="si">}</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="s2">* Tags: </span><span class="si">${</span><span class="nv">DOCUMENT_TAGS</span><span class="si">}</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="s2">It was consumed with the passphrase </span><span class="si">${</span><span class="nv">PASSPHRASE</span><span class="si">}</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="s2">&quot;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The post consumption script cannot cancel the consumption process.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The post consumption script should not modify the document files
directly</p>
</div>
<p>The script's stdout and stderr will be logged line by line to the
webserver log, along with the exit code of the script.</p>
<h3 id="docker-consume-hooks">Docker</h3>
<p>To hook into the consumption process when using Docker, you
will need to pass the scripts into the container via a host mount
in your <code>docker-compose.yml</code>.</p>
<p>Assuming you have
<code>/home/paperless-ngx/scripts/post-consumption-example.sh</code> as a
script which you'd like to run.</p>
<p>You can pass that script into the consumer container via a host mount:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nn">...</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nt">webserver</span><span class="p">:</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">volumes</span><span class="p p-Indicator">:</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- /home/paperless-ngx/scripts:/path/in/container/scripts/</span><span class="w"> </span><span class="c1"># (1)!</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="c1"># (3)!</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">PAPERLESS_POST_CONSUME_SCRIPT</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/in/container/scripts/post-consumption-example.sh</span><span class="w"> </span><span class="c1"># (2)!</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="nn">...</span>
</code></pre></div>
<ol>
<li>The external scripts directory is mounted to a location inside the container.</li>
<li>The internal location of the script is used to set the script to run</li>
<li>This can also be set in <code>docker-compose.env</code></li>
</ol>
<p>Troubleshooting:</p>
<ul>
<li>Monitor the docker-compose log
  <code>cd ~/paperless-ngx; docker-compose logs -f</code></li>
<li>Check your script's permission e.g. in case of permission error
  <code>sudo chmod 755 post-consumption-example.sh</code></li>
<li>Pipe your scripts's output to a log file e.g.
  <code>echo "${DOCUMENT_ID}" | tee --append /usr/src/paperless/scripts/post-consumption-example.log</code></li>
</ul>
<h2 id="file-name-handling">File name handling</h2>
<p>By default, paperless stores your documents in the media directory and
renames them using the identifier which it has assigned to each
document. You will end up getting files like <code>0000123.pdf</code> in your media
directory. This isn't necessarily a bad thing, because you normally
don't have to access these files manually. However, if you wish to name
your files differently, you can do that by adjusting the
<code>PAPERLESS_FILENAME_FORMAT</code> configuration option. Paperless adds the
correct file extension e.g. <code>.pdf</code>, <code>.jpg</code> automatically.</p>
<p>This variable allows you to configure the filename (folders are allowed)
using placeholders. For example, configuring this to</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">PAPERLESS_FILENAME_FORMAT</span><span class="o">={</span>created_year<span class="o">}</span>/<span class="o">{</span>correspondent<span class="o">}</span>/<span class="o">{</span>title<span class="o">}</span>
</code></pre></div>
<p>will create a directory structure as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>2019/
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>  My bank/
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    Statement January.pdf
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    Statement February.pdf
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>2020/
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>  My bank/
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    Statement January.pdf
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    Letter.pdf
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    Letter_01.pdf
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>  Shoe store/
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    My new shoes.pdf
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not manually move your files in the media folder. Paperless remembers
the last filename a document was stored as. If you do rename a file,
paperless will report your files as missing and won't be able to find
them.</p>
</div>
<p>Paperless provides the following placeholders within filenames:</p>
<ul>
<li><code>{asn}</code>: The archive serial number of the document, or "none".</li>
<li><code>{correspondent}</code>: The name of the correspondent, or "none".</li>
<li><code>{document_type}</code>: The name of the document type, or "none".</li>
<li><code>{tag_list}</code>: A comma separated list of all tags assigned to the
  document.</li>
<li><code>{title}</code>: The title of the document.</li>
<li><code>{created}</code>: The full date (ISO format) the document was created.</li>
<li><code>{created_year}</code>: Year created only, formatted as the year with
  century.</li>
<li><code>{created_year_short}</code>: Year created only, formatted as the year
  without century, zero padded.</li>
<li><code>{created_month}</code>: Month created only (number 01-12).</li>
<li><code>{created_month_name}</code>: Month created name, as per locale</li>
<li><code>{created_month_name_short}</code>: Month created abbreviated name, as per
  locale</li>
<li><code>{created_day}</code>: Day created only (number 01-31).</li>
<li><code>{added}</code>: The full date (ISO format) the document was added to
  paperless.</li>
<li><code>{added_year}</code>: Year added only.</li>
<li><code>{added_year_short}</code>: Year added only, formatted as the year without
  century, zero padded.</li>
<li><code>{added_month}</code>: Month added only (number 01-12).</li>
<li><code>{added_month_name}</code>: Month added name, as per locale</li>
<li><code>{added_month_name_short}</code>: Month added abbreviated name, as per
  locale</li>
<li><code>{added_day}</code>: Day added only (number 01-31).</li>
</ul>
<p>Paperless will try to conserve the information from your database as
much as possible. However, some characters that you can use in document
titles and correspondent names (such as <code>: \ /</code> and a couple more) are
not allowed in filenames and will be replaced with dashes.</p>
<p>If paperless detects that two documents share the same filename,
paperless will automatically append <code>_01</code>, <code>_02</code>, etc to the filename.
This happens if all the placeholders in a filename evaluate to the same
value.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can affect how empty placeholders are treated by changing the
following setting to <code>true</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>PAPERLESS_FILENAME_FORMAT_REMOVE_NONE=True
</code></pre></div>
<p>Doing this results in all empty placeholders resolving to "" instead
of "none" as stated above. Spaces before empty placeholders are
removed as well, empty directories are omitted.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Paperless checks the filename of a document whenever it is saved.
Therefore, you need to update the filenames of your documents and move
them after altering this setting by invoking the
<a href="/administration#renamer"><code>document renamer</code></a>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make absolutely sure you get the spelling of the placeholders right, or
else paperless will use the default naming scheme instead.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>As of now, you could totally tell paperless to store your files anywhere
outside the media directory by setting</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>PAPERLESS_FILENAME_FORMAT=../../my/custom/location/{title}
</code></pre></div>
<p>However, keep in mind that inside docker, if files get stored outside of
the predefined volumes, they will be lost after a restart of paperless.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When file naming handling, in particular when using <code>{tag_list}</code>,
you may run into the limits of your operating system's maximum
path lengths.  Files will retain the previous path instead and
the issue logged.</p>
</div>
<h2 id="storage-paths">Storage paths</h2>
<p>One of the best things in Paperless is that you can not only access the
documents via the web interface, but also via the file system.</p>
<p>When as single storage layout is not sufficient for your use case,
storage paths come to the rescue. Storage paths allow you to configure
more precisely where each document is stored in the file system.</p>
<ul>
<li>Each storage path is a <code>PAPERLESS_FILENAME_FORMAT</code> and
  follows the rules described above</li>
<li>Each document is assigned a storage path using the matching
  algorithms described above, but can be overwritten at any time</li>
</ul>
<p>For example, you could define the following two storage paths:</p>
<ol>
<li>Normal communications are put into a folder structure sorted by
    <code>year/correspondent</code></li>
<li>Communications with insurance companies are stored in a flat
    structure with longer file names, but containing the full date of
    the correspondence.</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>By Year = {created_year}/{correspondent}/{title}
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Insurances = Insurances/{correspondent}/{created_year}-{created_month}-{created_day} {title}
</code></pre></div>
<p>If you then map these storage paths to the documents, you might get the
following result. For simplicity, <code>By Year</code> defines the same
structure as in the previous example above.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>2019/                                   # By Year
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>   My bank/
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>     Statement January.pdf
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>     Statement February.pdf
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a> Insurances/                           # Insurances
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>   Healthcare 123/
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>     2022-01-01 Statement January.pdf
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>     2022-02-02 Letter.pdf
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>     2022-02-03 Letter.pdf
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>   Dental 456/
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>     2021-12-01 New Conditions.pdf
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Defining a storage path is optional. If no storage path is defined for a
document, the global <code>PAPERLESS_FILENAME_FORMAT</code> is applied.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you adjust the format of an existing storage path, old documents
don't get relocated automatically. You need to run the
<a href="/administration#renamer">document renamer</a> to
adjust their paths.</p>
</div>
<h2 id="celery-monitoring">Celery Monitoring</h2>
<p>The monitoring tool
<a href="https://flower.readthedocs.io/en/latest/index.html">Flower</a> can be used
to view more detailed information about the health of the celery workers
used for asynchronous tasks. This includes details on currently running,
queued and completed tasks, timing and more. Flower can also be used
with Prometheus, as it exports metrics. For details on its capabilities,
refer to the Flower documentation.</p>
<p>To configure Flower further, create a <code>flowerconfig.py</code> and
place it into the <code>src/paperless</code> directory. For a Docker
installation, you can use volumes to accomplish this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nt">services</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="c1"># ...</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="nt">webserver</span><span class="p">:</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5555:5555</span><span class="w"> </span><span class="c1"># (2)!</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="c1"># ...</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/my/flowerconfig.py:/usr/src/paperless/src/paperless/flowerconfig.py:ro</span><span class="w"> </span><span class="c1"># (1)!</span>
</code></pre></div>
<ol>
<li>Note the <code>:ro</code> tag means the file will be mounted as read only.</li>
<li><code>flower</code> runs by default on port 5555, but this can be configured</li>
</ol>
<h2 id="custom-container-initialization">Custom Container Initialization</h2>
<p>The Docker image includes the ability to run custom user scripts during
startup. This could be utilized for installing additional tools or
Python packages, for example. Scripts are expected to be shell scripts.</p>
<p>To utilize this, mount a folder containing your scripts to the custom
initialization directory, <code>/custom-cont-init.d</code> and place
scripts you wish to run inside. For security, the folder must be owned
by <code>root</code> and should have permissions of <code>a=rx</code>. Additionally, scripts
must only be writable by <code>root</code>.</p>
<p>Your scripts will be run directly before the webserver completes
startup. Scripts will be run by the <code>root</code> user.
If you would like to switch users, the utility <code>gosu</code> is available and
preferred over <code>sudo</code>.</p>
<p>This is an advanced functionality with which you could break functionality
or lose data. If you experience issues, please disable any custom scripts
and try again before reporting an issue.</p>
<p>For example, using Docker Compose:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">services</span><span class="p">:</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="c1"># ...</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="nt">webserver</span><span class="p">:</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="c1"># ...</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/my/scripts:/custom-cont-init.d:ro</span><span class="w"> </span><span class="c1"># (1)!</span>
</code></pre></div>
<ol>
<li>Note the <code>:ro</code> tag means the folder will be mounted as read only. This is for extra security against changes</li>
</ol>
<h2 id="mysql-caveats">MySQL Caveats</h2>
<h3 id="case-sensitivity">Case Sensitivity</h3>
<p>The database interface does not provide a method to configure a MySQL
database to be case sensitive. This would prevent a user from creating a
tag <code>Name</code> and <code>NAME</code> as they are considered the same.</p>
<p>Per Django documentation, to enable this requires manual intervention.
To enable case sensetive tables, you can execute the following command
against each table:</p>
<p><code>ALTER TABLE &lt;table_name&gt; CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;</code></p>
<p>You can also set the default for new tables (this does NOT affect
existing tables) with:</p>
<p><code>ALTER DATABASE &lt;db_name&gt; CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using mariadb version 10.4+ is recommended. Using the <code>utf8mb3</code> character set on
an older system may fix issues that can arise while setting up Paperless-ngx but
<code>utf8mb3</code> can cause issues with consumption (where <code>utf8mb4</code> does not).</p>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2016 - 2023 Daniel Quinn, Jonas Winkler, and the Paperless-ngx team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/paperless-ngx/paperless-ngx" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://hub.docker.com/r/paperlessngx/paperless-ngx" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://matrix.to/#/#paperless:matrix.org" target="_blank" rel="noopener" title="matrix.to" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3c5.5 0 10 3.58 10 8s-4.5 8-10 8c-1.24 0-2.43-.18-3.53-.5C5.55 21 2 21 2 21c2.33-2.33 2.7-3.9 2.75-4.5C3.05 15.07 2 13.13 2 11c0-4.42 4.5-8 10-8Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.top", "toc.integrate", "content.code.annotate"], "search": "../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.51d95adb.min.js"></script>
      
    
  </body>
</html>